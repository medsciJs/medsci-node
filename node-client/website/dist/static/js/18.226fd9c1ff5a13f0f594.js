webpackJsonp([18],{"9WXu":function(e,t,r){(e.exports=r("FZ+f")(!1)).push([e.i,"\n.bigInp[data-v-144dea01] {\n  width: 75%;\n}\n.el-select[data-v-144dea01] {\n  width: 100%;\n}\n.smallInp[data-v-144dea01] {\n  width: 23%;\n}\n",""])},BaZE:function(e,t,r){"use strict";t.d=function(e){return Object(i.a)({url:"/api1/regulation/getRegList",method:"post",data:e})},t.a=function(e){return Object(i.a)({url:"/api1/regulation/addRegulation",method:"post",data:e})},t.b=function(e){return Object(i.a)({url:"/api1/regulation/delRegulation",method:"post",data:e})},t.e=function(e){return Object(i.a)({url:"/api1/regulation/getWFNodes",method:"post",data:e})},t.f=function(e){return Object(i.a)({url:"/api1/regulation/updRegulation",method:"post",data:e})},t.c=function(e){return Object(i.a)({url:"/api1/regulation/getRegInfo",method:"get",params:e})};var i=r("vLgD")},jgEU:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("mvHQ"),l=r.n(i),s=r("BaZE"),o=r("P7dY"),n={data:function(){var e=new RegExp(/^[0-9]*$/);return{dialogTableVisible:!1,type:{companyId:"13",projectId:"1",pageIndex:0,pageSize:10,dictionaryType:"report-regulations"},types:[],num:0,he:0,number:0,hidden:!1,isAdd:!0,node:{},timeArr:[],ruleForm:{userId:"1",projectId:"1",companyId:"13",regulationName:"",severity:"",priority:"",finishedDate:"",deleteStatus:"",unit:"天",nodes:"",list:[]},rule:[],ruleArr:[{required:!0,message:"该字段不能为空",trigger:"blur"},{type:"number",message:"该字段必须为数字值"}],rules:{regulationName:[{required:!0,message:"请输入规则名称",trigger:"blur"}],severity:[{required:!0,message:"请选择严重性",trigger:"change"}],priority:[{required:!0,message:"请填写优先级",trigger:"blur"}],finishedDate:[{required:!0,validator:function(t,r,i){e.test(r)?""==r?i(new Error("该字段不能为空")):i():i(new Error("请输入数字"))},trigger:"blur"}]}}},mounted:function(){this.ruleForm.companyId=this.type.companyId=this.companyId,this.ruleForm.projectId=this.type.projectId=this.projectId,this.ruleForm.userId=this.type.userId=this.mixinUser.userId,this.getType(),this.rule=this.ruleArr},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.isAdd?t.add():t.change()})},getType:function(){var e=this;Object(o.b)(this.type).then(function(t){200==t.meta.code&&(e.types=t.body)})},change:function(){var e=this;if(this.ruleForm.updatedTime="",this.num=0,this.ruleForm.list.forEach(function(t){e.num+=Number(t.node)}),this.ruleForm.unit="天"==this.ruleForm.unit?1:2,this.ruleForm.finishedDate!=this.num)this.$message.warning("报告完成时间必须等于其下边项的和");else{var t=[];this.ruleForm.list.forEach(function(e){var r={label:"",value:""};r.label=e.nodeChineseName,r.value=e.node,t.push(r)}),this.ruleForm.nodes=l()(t),this.ruleForm.companyId=this.companyId,this.ruleForm.projectId=this.projectId,this.ruleForm.userId=this.mixinUser.userId,Object(s.f)(this.ruleForm).then(function(t){200==t.meta.code&&(e.$message.success("编辑成功"),e.$emit("getList"),e.dialogTableVisible=!1)})}},and:function(e,t){var r=this;this.timeArr[e]=t,this.timeArr.length==this.ruleForm.list.length&&this.ruleForm.finishedDate&&(this.num=0,this.timeArr.forEach(function(e){r.num+=Number(e)}),this.ruleForm.finishedDate!=this.num&&this.$message.warning("报告完成时间必须等于其下边项的和"))},add:function(){var e=this;this.ruleForm.updatedTime="",this.ruleForm.companyId=this.companyId,this.ruleForm.projectId=this.projectId,this.ruleForm.userId=this.mixinUser.userId,this.ruleForm.unit="天"==this.ruleForm.unit?1:2;var t=[];this.ruleForm.list.forEach(function(e,r){t.push({label:"",value:""}),t[r].label=e.nodeChineseName,t[r].value=e.node}),this.ruleForm.nodes=l()(t),this.ruleForm.finishedDate!=this.num?this.$message.warning("报告完成时间必须等于其下边项的和"):Object(s.a)(this.ruleForm).then(function(t){200==t.meta.code&&(e.$emit("getList"),e.$message.success("新建成功"),e.dialogTableVisible=!1)})},resetForm:function(e){this.$refs[e].resetFields()},close:function(e){this.dialogTableVisible=!1,this.rule=[],this.resetForm(e)},getseverity:function(){var e=this;Object(s.c)({id:this.id}).then(function(t){if(200==t.meta.code){e.ruleForm=t.body,e.ruleForm.unit=1==e.ruleForm.unit?"天":"时";var r=[];e.ruleForm.list=[],JSON.parse(e.ruleForm.nodes).forEach(function(e){var t={nodeChineseName:"",node:""};t.nodeChineseName=e.label,t.node=e.value,r.push(t)}),console.log(r),e.ruleForm.list=r}})}}},a={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("section",[r("el-dialog",{attrs:{title:"新建规则",visible:e.dialogTableVisible},on:{"update:visible":function(t){e.dialogTableVisible=t},close:function(t){e.close("ruleForm")}}},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,"label-width":"110px",rules:e.rules}},[r("el-form-item",{attrs:{label:"规则名称",prop:"regulationName"}},[r("el-input",{attrs:{clearable:""},model:{value:e.ruleForm.regulationName,callback:function(t){e.$set(e.ruleForm,"regulationName",t)},expression:"ruleForm.regulationName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"严重性",prop:"severity"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleForm.severity,callback:function(t){e.$set(e.ruleForm,"severity",t)},expression:"ruleForm.severity"}},e._l(e.types,function(e,t){return r("el-option",{key:t,attrs:{label:e.dictDisplayChinese,value:e.dictDisplayChinese}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"优先级",prop:"priority",rules:[{required:!0,message:"该字段不能为空",trigger:"blur"},{type:"number",message:"该字段必须为数字值"}]}},[r("el-input",{attrs:{clearable:""},model:{value:e.ruleForm.priority,callback:function(t){e.$set(e.ruleForm,"priority",e._n(t))},expression:"ruleForm.priority"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"报告完成时间",prop:"finishedDate"}},[r("el-input",{staticClass:"bigInp",attrs:{clearable:""},model:{value:e.ruleForm.finishedDate,callback:function(t){e.$set(e.ruleForm,"finishedDate",t)},expression:"ruleForm.finishedDate"}}),e._v(" "),r("el-select",{staticClass:"smallInp",attrs:{placeholder:""},model:{value:e.ruleForm.unit,callback:function(t){e.$set(e.ruleForm,"unit",t)},expression:"ruleForm.unit"}},[r("el-option",{attrs:{label:"天",value:"天"}}),e._v(" "),r("el-option",{attrs:{label:"时",value:"时"}})],1)],1),e._v(" "),e._l(e.ruleForm.list,function(t,i){return r("el-form-item",{key:i,attrs:{label:t.nodeChineseName,prop:"list."+i+".node",rules:e.rule}},[r("el-input",{staticClass:"bigInp",attrs:{clearable:""},on:{change:function(r){e.and(i,t.node)}},model:{value:t.node,callback:function(r){e.$set(t,"node",e._n(r))},expression:"item.node"}}),e._v(" "),r("el-select",{staticClass:"smallInp",attrs:{placeholder:""},model:{value:e.ruleForm.unit,callback:function(t){e.$set(e.ruleForm,"unit",t)},expression:"ruleForm.unit"}},[r("el-option",{attrs:{label:"天",value:"1"}}),e._v(" "),r("el-option",{attrs:{label:"时",value:"2"}})],1)],1)}),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v("保存")]),e._v(" "),r("el-button",{attrs:{type:"info"},on:{click:function(t){e.close("ruleForm")}}},[e._v("关闭")])],1)],2)],1)],1)])},staticRenderFns:[]};var u=r("VU/8")(n,a,!1,function(e){r("xvRX")},"data-v-144dea01",null);t.default=u.exports},xvRX:function(e,t,r){var i=r("9WXu");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);r("rjj0")("b62e3384",i,!0)}});